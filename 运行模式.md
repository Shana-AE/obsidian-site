---
tags:
  - wujie
  - 生命周期
---
![运行模式](./运行模式.excalidraw|2000)

保活、单例、重建

- 保活：
     子应用alive为true时进入保活模式，类似keep-alive
     但需要注意url变化子应用路由不会变化，需要采用[[./通信系统|通信系统]]方式对子应用路由跳转
     注意：保活实例不销毁，能响应bus事件，非保活切走销毁时间，重新mount后重新监听
- 单例
  alive为false，进行了[[./生命周期改造|生命周期改造]]
  切走，调用`window.__WUJIE_UNMOUNT`,切回来调用 `window.__WUJIE_MOUNT
  改变url 子应用会发生跳转到对应路由
  （如果主应用上有多个菜单栏用到了子应用的不同页面，在每个页面启动该子应用的时候将`name`设置为同一个，这样可以共享一个`wujie`实例，承载子应用`js`的`iframe`也实现了共享，不同页面子应用的`url`不同，切换这个子应用的过程相当于：销毁当前应用实例 => 同步新路由 => 创建新应用实例）暂时还未太理解
  大概是可以通过name相同放到一个实例（单例）中，iframe共享，通过url不同mount后创建实例？
  
- 重建
  其他方式，每次切换，响应的wujie实例，iframe，webcomponent等也会被销毁
  重建模式改url子应用可以跳路由，（但[[路由同步]]场景且子应用路由同步参数同步到中应用url上时则无法生效，因为改变`url`后会导致子应用销毁重新渲染，此时如果有同步参数则同步参数的优先级最高）此处需要再看看
- 